<!-- Jedálny lístok – pekne centrovaný card -->
<section class="menu-section">
  <div class="menu-card">
    <h2 class="menu-title">Jedálny lístok</h2>

    <a id="menuLink" class="menu-imgwrap" target="_blank" rel="noopener">
      <img id="menuImg" alt="Jedálny lístok" class="menu-img menu-skeleton" loading="lazy">
    </a>

    <div class="menu-meta">
      <span id="menuDate">Aktualizujem…</span>
      <span class="dot">•</span>
      <span class="hint">Klik pre plné rozlíšenie</span>
    </div>
  </div>
</section>

<style>
  /* Jemný, moderný vzhľad – ladí s väčšinou tmavších aj svetlejších tém */
  :root{
    --card-bg: color-mix(in oklab, Canvas 94%, transparent);
    --card-border: color-mix(in oklab, CanvasText 10%, transparent);
    --text: CanvasText;
    --muted: color-mix(in oklab, CanvasText 55%, transparent);
    --shadow: 0 8px 30px rgba(0,0,0,.08);
  }
  @media (prefers-color-scheme: dark){
    :root{
      --card-bg: color-mix(in oklab, Canvas 6%, transparent);
      --card-border: color-mix(in oklab, CanvasText 14%, transparent);
      --shadow: 0 8px 30px rgba(0,0,0,.35);
    }
  }

  .menu-section{
    display:flex; justify-content:center; padding:clamp(16px,4vw,48px);
  }
  .menu-card{
    width:min(100%, 980px);
    background:var(--card-bg);
    border:1px solid var(--card-border);
    border-radius:16px;
    box-shadow:var(--shadow);
    padding:clamp(16px,3vw,28px);
  }
  .menu-title{
    margin:0 0 14px; font-size:clamp(22px,2.4vw,28px); text-align:center; color:var(--text);
    letter-spacing:.3px;
  }
  .menu-imgwrap{ display:block; border-radius:12px; overflow:hidden; }
  .menu-img{
    width:100%; height:auto; display:block; border-radius:12px;
    transform:translateZ(0);
  }
  .menu-imgwrap:hover .menu-img{ filter:contrast(1.02); }
  .menu-meta{
    margin-top:10px; display:flex; gap:8px; align-items:center; justify-content:center;
    color:var(--muted); font-size:14px;
  }
  .menu-meta .dot{ opacity:.6 }
  /* Skeleton počas načítania */
  .menu-skeleton{
    background:linear-gradient(90deg, #0000, #0001, #0000);
    background-size:200% 100%;
    animation:shimmer 1.2s infinite;
  }
  @keyframes shimmer{ 0%{background-position:0 0} 100%{background-position:-200% 0} }
</style>

<script>
  (function(){
    const imgEl   = document.getElementById('menuImg');
    const linkEl  = document.getElementById('menuLink');
    const dateEl  = document.getElementById('menuDate');
    const bust    = new Date().toISOString().slice(0,10); // jednoduchý cache-bust

    const localSrc = '/assets/menu.jpg?v=' + bust;
    imgEl.src = localSrc;
    linkEl.href = localSrc;

    // odstráň skeleton po načítaní
    imgEl.addEventListener('load', ()=> imgEl.classList.remove('menu-skeleton'));

    // Skús zobraziť „Aktualizované …“ a link na originál (využijeme JSON, ktorý ukladá Action)
    fetch('/assets/menu.jpg.json?'+bust).then(r => r.ok ? r.json() : null).then(meta => {
      if (!meta) return;
      try{
        const d = new Date(meta.fetchedAt);
        dateEl.textContent = 'Aktualizované: ' + d.toLocaleDateString('sk-SK', { day:'2-digit', month:'2-digit', year:'numeric' });
        if (meta.img) linkEl.href = meta.img; // klik otvorí originál vo full rozlíšení
      }catch(_){}
    }).catch(()=>{ /* ticho */ });
  })();
</script>

<noscript>
  <img src="/assets/menu.jpg" alt="Jedálny lístok" style="display:block;margin:24px auto;max-width:980px;width:100%;border-radius:12px;">
</noscript>
